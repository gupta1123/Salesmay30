(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[853],{62546:function(e,t,n){"use strict";n.d(t,{I:function(){return d}});var a=n(59499),r=n(4730),s=n(67294),c=n(20439),i=n(85893),o=["className","type"];function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var d=s.forwardRef(function(e,t){var n=e.className,s=e.type,d=(0,r.Z)(e,o);return(0,i.jsx)("input",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){(0,a.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({type:s,className:(0,c.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",n),ref:t},d))});d.displayName="Input"},89899:function(e,t,n){"use strict";n.d(t,{Bw:function(){return D},Ph:function(){return j},Ql:function(){return O},i4:function(){return g},ki:function(){return b}});var a=n(59499),r=n(4730),s=n(67294),c=n(62469),i=n(95059),o=n(20439),l=n(85893),d=["className","children"],u=["className"],f=["className"],m=["className","children","position"],p=["className"],h=["className","children"],x=["className"];function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach(function(t){(0,a.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var j=i.fC;i.ZA;var b=i.B4,g=s.forwardRef(function(e,t){var n=e.className,a=e.children,s=(0,r.Z)(e,d);return(0,l.jsxs)(i.xz,v(v({ref:t,className:(0,o.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",n)},s),{},{children:[a,(0,l.jsx)(i.JO,{asChild:!0,children:(0,l.jsx)(c.jnn,{className:"h-4 w-4 opacity-50"})})]}))});g.displayName=i.xz.displayName;var N=s.forwardRef(function(e,t){var n=e.className,a=(0,r.Z)(e,u);return(0,l.jsx)(i.u_,v(v({ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",n)},a),{},{children:(0,l.jsx)(c.g8U,{})}))});N.displayName=i.u_.displayName;var w=s.forwardRef(function(e,t){var n=e.className,a=(0,r.Z)(e,f);return(0,l.jsx)(i.$G,v(v({ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",n)},a),{},{children:(0,l.jsx)(c.v4q,{})}))});w.displayName=i.$G.displayName;var D=s.forwardRef(function(e,t){var n=e.className,a=e.children,s=e.position,c=void 0===s?"popper":s,d=(0,r.Z)(e,m);return(0,l.jsx)(i.h_,{children:(0,l.jsxs)(i.VY,v(v({ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===c&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:c},d),{},{children:[(0,l.jsx)(N,{}),(0,l.jsx)(i.l_,{className:(0,o.cn)("p-1","popper"===c&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,l.jsx)(w,{})]}))})});D.displayName=i.VY.displayName,s.forwardRef(function(e,t){var n=e.className,a=(0,r.Z)(e,p);return(0,l.jsx)(i.__,v({ref:t,className:(0,o.cn)("px-2 py-1.5 text-sm font-semibold",n)},a))}).displayName=i.__.displayName;var O=s.forwardRef(function(e,t){var n=e.className,a=e.children,s=(0,r.Z)(e,h);return(0,l.jsxs)(i.ck,v(v({ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n)},s),{},{children:[(0,l.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,l.jsx)(i.wU,{children:(0,l.jsx)(c.nQG,{className:"h-4 w-4"})})}),(0,l.jsx)(i.eT,{children:a})]}))});O.displayName=i.ck.displayName,s.forwardRef(function(e,t){var n=e.className,a=(0,r.Z)(e,x);return(0,l.jsx)(i.Z0,v({ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",n)},a))}).displayName=i.Z0.displayName},65716:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var a=n(59499),r=n(50029),s=n(64687),c=n.n(s),i=n(67294),o=n(45007),l=n(83594),d=n(89899),u=n(62546);let f=i.createContext({});function m({count:e=1,wrapper:t,className:n,containerClassName:a,containerTestId:r,circle:s=!1,style:c,...o}){var l,d,u;let m=i.useContext(f),p={...o};for(let[e,t]of Object.entries(o))void 0===t&&delete p[e];let h={...m,...p,circle:s},x={...c,...function({baseColor:e,highlightColor:t,width:n,height:a,borderRadius:r,circle:s,direction:c,duration:i,enableAnimation:o=!0,customHighlightBackground:l}){let d={};return"rtl"===c&&(d["--animation-direction"]="reverse"),"number"==typeof i&&(d["--animation-duration"]=`${i}s`),o||(d["--pseudo-element-display"]="none"),("string"==typeof n||"number"==typeof n)&&(d.width=n),("string"==typeof a||"number"==typeof a)&&(d.height=a),("string"==typeof r||"number"==typeof r)&&(d.borderRadius=r),s&&(d.borderRadius="50%"),void 0!==e&&(d["--base-color"]=e),void 0!==t&&(d["--highlight-color"]=t),"string"==typeof l&&(d["--custom-highlight-background"]=l),d}(h)},y="react-loading-skeleton";n&&(y+=` ${n}`);let v=null!==(l=h.inline)&&void 0!==l&&l,j=[],b=Math.ceil(e);for(let t=0;t<b;t++){let n=x;if(b>e&&t===b-1){let t=null!==(d=n.width)&&void 0!==d?d:"100%",a=e%1,r="number"==typeof t?t*a:`calc(${t} * ${a})`;n={...n,width:r}}let a=i.createElement("span",{className:y,style:n,key:t},"â€Œ");v?j.push(a):j.push(i.createElement(i.Fragment,{key:t},a,i.createElement("br",null)))}return i.createElement("span",{className:a,"data-testid":r,"aria-live":"polite","aria-busy":null===(u=h.enableAnimation)||void 0===u||u},t?j.map((e,n)=>i.createElement(t,{key:n},e)):j)}n(58862);var p=n(85893),h=(0,i.createContext)(void 0),x=function(e){var t=e.children,n=(0,i.useState)({startDate:null,endDate:null,employeeName:""}),a=n[0],r=n[1];return(0,p.jsx)(h.Provider,{value:{filters:a,setFilters:r},children:t})},y=n(92326);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach(function(t){(0,a.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}n(55287);var b=function(){var e,t=(0,i.useState)([]),n=t[0],a=t[1],s=(0,i.useState)([]),f=s[0],h=s[1],v=(0,i.useState)(new Date().getFullYear()),b=v[0],g=v[1],N=(0,i.useState)(new Date().getMonth()),w=N[0],D=N[1],O=(0,i.useState)(""),k=O[0],S=O[1],C=(0,i.useState)(""),_=C[0],P=C[1],E=(0,i.useState)(!0),A=E[0],Z=E[1],F=(0,i.useState)(!1),R=F[0],L=F[1],B=(0,i.useState)([]),M=B[0],z=B[1],I=(0,i.useState)(""),T=I[0],Y=I[1],G=(0,i.useState)(""),J=G[0],$=G[1],V=Array.from({length:27},function(e,t){return 2024+t}),X=(0,o.v9)(function(e){return e.auth.token}),Q=(0,i.useCallback)((0,r.Z)(c().mark(function e(){var t;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(X){e.next=3;break}return console.error("Auth token is missing"),e.abrupt("return");case 3:return e.prev=3,e.next=6,fetch("https://api.gajkesaristeels.in/employee/getAll",{headers:{Authorization:"Bearer ".concat(X)}});case 6:if((t=e.sent).ok){e.next=9;break}throw Error("Failed to fetch employees");case 9:return e.next=11,t.json();case 11:h(e.sent),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),console.error("Error fetching employees:",e.t0);case 18:case"end":return e.stop()}},e,null,[[3,15]])})),[X]),H=(0,i.useCallback)((0,r.Z)(c().mark(function e(){var t,n,r,s,i,o;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Z(!0),X){e.next=4;break}return console.error("Auth token is missing"),e.abrupt("return");case 4:return t=new Date(b,w,1).toISOString().split("T")[0],(r=new Date(n=new Date(b,w+1,0))).setDate(n.getDate()+1),s=r.toISOString().split("T")[0],e.prev=9,e.next=12,fetch("https://api.gajkesaristeels.in/attendance-log/getForRange1?start=".concat(t,"&end=").concat(s),{headers:{Authorization:"Bearer ".concat(X)}});case 12:if((i=e.sent).ok){e.next=15;break}throw Error("Failed to fetch attendance data");case 15:return e.next=17,i.json();case 17:a((o=e.sent).map(function(e){return"Present"===e.attendanceStatus?j(j({},e),{},{attendanceStatus:"full day"}):e})),S(""),0===o.length&&S("No data available for the selected month and year. Please choose a different month or year."),e.next=29;break;case 24:e.prev=24,e.t0=e.catch(9),console.error("Error fetching attendance data:",e.t0),a([]),S("No data available for the selected month and year. Please choose a different month or year.");case 29:Z(!1);case 30:case"end":return e.stop()}},e,null,[[9,24]])})),[X,b,w]),U=(0,i.useCallback)((e=(0,r.Z)(c().mark(function e(t,n){var a,r;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(X){e.next=3;break}return console.error("Auth token is missing"),e.abrupt("return");case 3:return e.prev=3,e.next=6,fetch("https://api.gajkesaristeels.in/visit/getByDateSorted?startDate=".concat(t,"&endDate=").concat(t,"&employeeName=").concat(n,"&page=0&size=100&sort=id,desc"),{headers:{Authorization:"Bearer ".concat(X)}});case 6:if((a=e.sent).ok){e.next=9;break}throw Error("Failed to fetch visit data");case 9:return e.next=11,a.json();case 11:z((r=e.sent.content.filter(function(e){return e.employeeName===n}))||[]),Y(t),$(n),L(!0),0===r.length&&z([]),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(3),console.error("Error fetching visit data:",e.t0),z([]);case 24:case"end":return e.stop()}},e,null,[[3,20]])})),function(t,n){return e.apply(this,arguments)}),[X]);(0,i.useEffect)(function(){H(),Q()},[b,w,X,H,Q]);var q=f.filter(function(e){return"".concat(e.firstName," ").concat(e.lastName).toLowerCase().includes(_.toLowerCase())}).sort(function(e,t){var n="".concat(e.firstName," ").concat(e.lastName).toLowerCase(),a="".concat(t.firstName," ").concat(t.lastName).toLowerCase();return n.localeCompare(a)});return(0,p.jsx)(x,{children:(0,p.jsxs)("div",{className:"container mx-auto py-8 px-4 sm:px-8",children:[(0,p.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4",children:[(0,p.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-4 sm:space-y-0 sm:space-x-4",children:[(0,p.jsx)("div",{className:"w-full sm:w-auto",children:(0,p.jsxs)(d.Ph,{value:b.toString(),onValueChange:function(e){return g(parseInt(e))},children:[(0,p.jsx)(d.i4,{className:"w-[180px]",children:(0,p.jsx)(d.ki,{placeholder:"Select a year"})}),(0,p.jsx)(d.Bw,{children:V.map(function(e){return(0,p.jsx)(d.Ql,{value:e.toString(),children:e},e)})})]})}),(0,p.jsx)("div",{children:(0,p.jsxs)(d.Ph,{value:w.toString(),onValueChange:function(e){return D(parseInt(e))},children:[(0,p.jsx)(d.i4,{className:"w-[180px]",children:(0,p.jsx)(d.ki,{placeholder:"Select a month"})}),(0,p.jsx)(d.Bw,{children:["January","February","March","April","May","June","July","August","September","October","November","December"].map(function(e,t){return(0,p.jsx)(d.Ql,{value:t.toString(),children:e},e)})})]})}),(0,p.jsx)("div",{children:(0,p.jsx)(u.I,{type:"text",placeholder:"Filter by name",value:_,onChange:function(e){return P(e.target.value)}})})]}),(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsx)("p",{className:"text-lg font-bold",children:"Legend:"}),(0,p.jsxs)("div",{className:"flex space-x-4",children:[(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"w-4 h-4 bg-green-500 mr-2"}),(0,p.jsx)("p",{children:"Full Day"})]}),(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"w-4 h-4 bg-yellow-500 mr-2"}),(0,p.jsx)("p",{children:"Half Day"})]}),(0,p.jsxs)("div",{className:"flex items-center",children:[(0,p.jsx)("div",{className:"w-4 h-4 bg-red-500 mr-2"}),(0,p.jsx)("p",{children:"Absent"})]})]})]})]}),k&&(0,p.jsx)("p",{className:"mb-4 text-red-500",children:k}),(0,p.jsx)("div",{className:"space-y-4",children:A?Array.from({length:5}).map(function(e,t){return(0,p.jsx)(m,{height:200},t)}):(0,p.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:q.map(function(e){var t=n.filter(function(t){return t.employeeId===e.id}),a=t.map(function(e){return new Date(e.checkinDate).getDate()});return console.log("Dates passed to AttendanceCard for ".concat(e.firstName," ").concat(e.lastName,":"),a),(0,p.jsx)(l.default,{employee:e,initialSummary:{fullDays:0,halfDays:0,absentDays:0},selectedYear:b,selectedMonth:w,attendanceData:t,onDateClick:function(e,t){return U(e,t)}},e.id)})})}),(0,p.jsx)(y.default,{isOpen:R,onClose:function(){return L(!1)},visitData:M,selectedDate:T,employeeName:J})]})})}},83594:function(e,t,n){"use strict";n.r(t);var a=n(67294),r=n(43359),s=n(99603),c=n(59417),i=n(57129),o=n.n(i),l=n(85893);t.default=a.memo(function(e){var t=e.employee,n=e.attendanceData,i=e.selectedYear,d=e.selectedMonth,u=e.initialSummary,f=e.onDateClick,m=(0,a.useState)(u),p=m[0],h=m[1],x=(0,a.useCallback)(function(e){h(e)},[]),y=(0,a.useMemo)(function(){return n.filter(function(e){return e.employeeId===t.id})},[n,t.id]),v=(0,a.useMemo)(function(){return"".concat(t.firstName," ").concat(t.lastName)},[t.firstName,t.lastName]),j=(0,a.useCallback)(function(e){f(e,v)},[f,v]),b=n.map(function(e){return new Date(e.checkinDate).getDate()});return console.log("Employee: ".concat(v),b),(0,l.jsxs)("div",{className:o()["info-card"],children:[(0,l.jsxs)("div",{className:o().info,children:[(0,l.jsx)("h2",{children:v}),(0,l.jsxs)("div",{className:o().stats,children:[(0,l.jsxs)("div",{className:o()["stat-box"],children:[(0,l.jsx)(s.G,{icon:c.enB}),(0,l.jsx)("p",{children:"Full"}),(0,l.jsx)("h3",{children:p.fullDays})]}),(0,l.jsxs)("div",{className:o()["stat-box"],children:[(0,l.jsx)(s.G,{icon:c.S9Y}),(0,l.jsx)("p",{children:"Half"}),(0,l.jsx)("h3",{children:p.halfDays})]}),(0,l.jsxs)("div",{className:o()["stat-box"],children:[(0,l.jsx)(s.G,{icon:c.nYk}),(0,l.jsx)("p",{children:"Absent"}),(0,l.jsx)("h3",{children:p.absentDays})]})]})]}),(0,l.jsx)("div",{className:o()["calendar-container"],children:(0,l.jsx)(r.default,{month:d,year:i,attendanceData:y,onSummaryChange:x,onDateClick:j,employeeName:v})})]})})},43359:function(e,t,n){"use strict";n.r(t);var a=n(67294);n(26779);var r=n(85893);t.default=function(e){var t=e.month,n=e.year,s=e.attendanceData,c=e.onSummaryChange,i=e.onDateClick,o=e.employeeName,l=(0,a.useRef)(null);return(0,a.useEffect)(function(){!function(){if(l.current){l.current.innerHTML="";for(var e=new Date(n,t,1).getDay(),a=new Date(n,t+1,0).getDate(),r=0,d=0,u=0,f=0;f<e;f++){var m=document.createElement("div");m.classList.add("empty"),l.current.appendChild(m)}for(var p=1;p<=a;p++)!function(){var e=document.createElement("div");e.textContent=p.toString();var a="".concat(n,"-").concat(String(t+1).padStart(2,"0"),"-").concat(String(p).padStart(2,"0")),c=new Date(n,t,p),f=s.find(function(e){return e.checkinDate.split("T")[0]===a}),m=null==f?void 0:f.attendanceStatus,h=document.createElement("span");h.classList.add("calendar-tooltip"),m?(e.classList.add(m.toLowerCase().replace(" ","-")),h.textContent=" ".concat(m),"full day"===m?r++:"half day"===m?d++:"Absent"===m&&u++):0===c.getDay()&&(e.classList.add("full-day"),h.textContent="Full Day",r++),e.appendChild(h),e.addEventListener("mouseover",function(){var t=e.getBoundingClientRect(),n=h.getBoundingClientRect(),a=l.current.getBoundingClientRect();h.style.left="",h.style.right="",h.style.transform="",t.left-n.width/2<a.left?(h.style.left="0",h.style.transform="translateX(0)"):t.right+n.width/2>a.right?(h.style.right="0",h.style.left="auto",h.style.transform="translateX(0)"):(h.style.left="50%",h.style.transform="translateX(-50%)")}),e.addEventListener("click",function(){i(a,o)}),l.current.appendChild(e)}();c({fullDays:r,halfDays:d,absentDays:u})}}()},[t,n,s,c,o,i]),(0,r.jsxs)("div",{className:"custom-calendar",children:[(0,r.jsxs)("div",{className:"calendar-days",children:[(0,r.jsx)("div",{children:"S"}),(0,r.jsx)("div",{children:"M"}),(0,r.jsx)("div",{children:"T"}),(0,r.jsx)("div",{children:"W"}),(0,r.jsx)("div",{children:"T"}),(0,r.jsx)("div",{children:"F"}),(0,r.jsx)("div",{children:"S"})]}),(0,r.jsx)("div",{className:"calendar-dates",ref:l})]})}},71080:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/Attendance",function(){return n(65716)}])},58862:function(){},55287:function(){},26779:function(){},57129:function(e){e.exports={"info-card":"AttendanceCard_info-card__wfYJ8",info:"AttendanceCard_info__6_k7V",stats:"AttendanceCard_stats__dmS2f","stat-box":"AttendanceCard_stat-box__FJ2Fd","calendar-container":"AttendanceCard_calendar-container__5jx23"}}},function(e){e.O(0,[4976,9545,6066,5059,9603,5443,2326,2888,9774,179],function(){return e(e.s=71080)}),_N_E=e.O()}]);