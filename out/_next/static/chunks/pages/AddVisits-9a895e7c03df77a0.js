(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1323],{29222:function(e,t,r){"use strict";r.d(t,{d:function(){return f},z:function(){return p}});var n=r(59499),a=r(4730),s=r(67294),o=r(88426),i=r(12003),c=r(20439),d=r(85893),l=["className","variant","size","asChild"];function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var f=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),p=s.forwardRef(function(e,t){var r=e.className,s=e.variant,i=e.size,p=e.asChild,m=(0,a.Z)(e,l),h=void 0!==p&&p?o.g7:"button";return(0,d.jsx)(h,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({className:(0,c.cn)(f({variant:s,size:i,className:r})),ref:t},m))});p.displayName="Button"},56853:function(e,t,r){"use strict";r.d(t,{f:function(){return h}});var n=r(77191),a=r(36864),s=r(59499),o=r(4730);r(67294);var i=r(62469),c=r(65905),d=r(20439),l=r(29222),u=r(85893),f=["className","classNames","showOutsideDays"];function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach(function(t){(0,s.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function h(e){var t=e.className,r=e.classNames,s=e.showOutsideDays,p=(0,o.Z)(e,f);return(0,u.jsx)(c._W,m({showOutsideDays:void 0===s||s,className:(0,d.cn)("p-3",t),classNames:m({months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,d.cn)((0,l.d)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-8 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:(0,d.cn)("relative p-0 text-center text-sm focus-within:relative focus-within:z-20 [&:has([aria-selected])]:bg-accent [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected].day-range-end)]:rounded-r-md","range"===p.mode?"[&:has(>.day-range-end)]:rounded-r-md [&:has(>.day-range-start)]:rounded-l-md first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md":"[&:has([aria-selected])]:rounded-md"),day:(0,d.cn)((0,l.d)({variant:"ghost"}),"h-8 w-8 p-0 font-normal aria-selected:opacity-100"),day_range_start:"day-range-start",day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50  aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible"},r),components:{IconLeft:function(e){return(0,a.Z)({},((0,n.Z)(e),e)),(0,u.jsx)(i.wyc,{className:"h-4 w-4"})},IconRight:function(e){return(0,a.Z)({},((0,n.Z)(e),e)),(0,u.jsx)(i.XCv,{className:"h-4 w-4"})}}},p))}h.displayName="Calendar"},62546:function(e,t,r){"use strict";r.d(t,{I:function(){return l}});var n=r(59499),a=r(4730),s=r(67294),o=r(20439),i=r(85893),c=["className","type"];function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var l=s.forwardRef(function(e,t){var r=e.className,s=e.type,l=(0,a.Z)(e,c);return(0,i.jsx)("input",function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({type:s,className:(0,o.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r),ref:t},l))});l.displayName="Input"},20072:function(e,t,r){"use strict";r.d(t,{J2:function(){return u},xo:function(){return f},yk:function(){return p}});var n=r(59499),a=r(4730),s=r(67294),o=r(86419),i=r(20439),c=r(85893),d=["className","align","sideOffset"];function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var u=o.fC,f=o.xz;o.ee;var p=s.forwardRef(function(e,t){var r=e.className,s=e.align,u=e.sideOffset,f=(0,a.Z)(e,d);return(0,c.jsx)(o.h_,{children:(0,c.jsx)(o.VY,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({ref:t,align:void 0===s?"center":s,sideOffset:void 0===u?4:u,className:(0,i.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r)},f))})});p.displayName=o.VY.displayName},89899:function(e,t,r){"use strict";r.d(t,{Bw:function(){return N},Ph:function(){return g},Ql:function(){return P},i4:function(){return j},ki:function(){return x}});var n=r(59499),a=r(4730),s=r(67294),o=r(62469),i=r(95059),c=r(20439),d=r(85893),l=["className","children"],u=["className"],f=["className"],p=["className","children","position"],m=["className"],h=["className","children"],y=["className"];function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var g=i.fC;i.ZA;var x=i.B4,j=s.forwardRef(function(e,t){var r=e.className,n=e.children,s=(0,a.Z)(e,l);return(0,d.jsxs)(i.xz,v(v({ref:t,className:(0,c.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r)},s),{},{children:[n,(0,d.jsx)(i.JO,{asChild:!0,children:(0,d.jsx)(o.jnn,{className:"h-4 w-4 opacity-50"})})]}))});j.displayName=i.xz.displayName;var O=s.forwardRef(function(e,t){var r=e.className,n=(0,a.Z)(e,u);return(0,d.jsx)(i.u_,v(v({ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",r)},n),{},{children:(0,d.jsx)(o.g8U,{})}))});O.displayName=i.u_.displayName;var w=s.forwardRef(function(e,t){var r=e.className,n=(0,a.Z)(e,f);return(0,d.jsx)(i.$G,v(v({ref:t,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",r)},n),{},{children:(0,d.jsx)(o.v4q,{})}))});w.displayName=i.$G.displayName;var N=s.forwardRef(function(e,t){var r=e.className,n=e.children,s=e.position,o=void 0===s?"popper":s,l=(0,a.Z)(e,p);return(0,d.jsx)(i.h_,{children:(0,d.jsxs)(i.VY,v(v({ref:t,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===o&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:o},l),{},{children:[(0,d.jsx)(O,{}),(0,d.jsx)(i.l_,{className:(0,c.cn)("p-1","popper"===o&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,d.jsx)(w,{})]}))})});N.displayName=i.VY.displayName,s.forwardRef(function(e,t){var r=e.className,n=(0,a.Z)(e,m);return(0,d.jsx)(i.__,v({ref:t,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",r)},n))}).displayName=i.__.displayName;var P=s.forwardRef(function(e,t){var r=e.className,n=e.children,s=(0,a.Z)(e,h);return(0,d.jsxs)(i.ck,v(v({ref:t,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r)},s),{},{children:[(0,d.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(i.wU,{children:(0,d.jsx)(o.nQG,{className:"h-4 w-4"})})}),(0,d.jsx)(i.eT,{children:n})]}))});P.displayName=i.ck.displayName,s.forwardRef(function(e,t){var r=e.className,n=(0,a.Z)(e,y);return(0,d.jsx)(i.Z0,v({ref:t,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",r)},n))}).displayName=i.Z0.displayName},29410:function(e,t,r){"use strict";r.r(t);var n=r(59499),a=r(50029),s=r(64687),o=r.n(s),i=r(67294),c=r(45007),d=r(29222),l=r(62546),u=r(61711),f=r(56853),p=r(20072),m=r(89899),h=r(62469),y=r(20439),b=r(83800),v=r(85893);function g(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}t.default=function(e){var t,r,s=e.closeModal,x=(0,i.useState)(void 0),j=x[0],O=x[1],w=(0,i.useState)(""),N=w[0],P=w[1],_=(0,i.useState)(""),k=_[0],S=_[1],E=(0,i.useState)([]),D=E[0],Z=E[1],z=(0,i.useState)(""),C=z[0],A=z[1],I=(0,i.useState)([]),R=I[0],B=I[1],V=(0,i.useState)(null),F=V[0],G=V[1],U=(0,i.useState)(""),M=U[0],Q=U[1],T=(0,i.useState)(!1),J=T[0],W=T[1],Y=(0,i.useRef)(null),L=(0,c.v9)(function(e){return e.auth.token}),X=(0,c.v9)(function(e){return e.auth.role}),$=(0,c.v9)(function(e){return e.auth.employeeId}),q=(0,c.v9)(function(e){return e.auth.employeeId}),H=(0,i.useCallback)((0,a.Z)(o().mark(function e(){var t,r,n,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r="MANAGER"===X?"https://api.gajkesaristeels.in/employee/team/getbyEmployee?id=".concat($):"https://api.gajkesaristeels.in/employee/getAll",e.next=4,fetch(r,{headers:{Authorization:"Bearer ".concat(L)}});case 4:return n=e.sent,e.next=7,n.json();case 7:a=e.sent,Z("MANAGER"===X?(null===(t=a[0])||void 0===t?void 0:t.fieldOfficers)||[]:Array.isArray(a)?a:[]),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Error fetching employees:",e.t0);case 14:case"end":return e.stop()}},e,null,[[0,11]])})),[X,$,L]),K=(0,i.useCallback)((t=(0,a.Z)(o().mark(function e(t){var r,n,a,s,i=arguments;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:"",e.prev=1,n="https://api.gajkesaristeels.in/store/getByEmployeeWithSort?id=".concat(t,"&storeName=").concat(encodeURIComponent(r),"&sortBy=storeName&sortOrder=asc"),e.next=5,fetch(n,{headers:{Authorization:"Bearer ".concat(L)}});case 5:return a=e.sent,e.next=8,a.json();case 8:Array.isArray((s=e.sent).content)?B(s.content.map(function(e){return{storeId:e.storeId,storeName:e.storeName}})):console.error("Unexpected response format:",s),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.error("Error fetching stores:",e.t0);case 15:case"end":return e.stop()}},e,null,[[1,12]])})),function(e){return t.apply(this,arguments)}),[L]);(0,i.useEffect)(function(){H()},[H]),(0,i.useEffect)(function(){C&&K(C,M)},[C,M,K]),(0,i.useEffect)(function(){var e=function(e){Y.current&&!Y.current.contains(e.target)&&W(!1)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}},[]);var ee=(r=(0,a.Z)(o().mark(function e(t){var r,a;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),F){e.next=4;break}return console.error("No store selected"),e.abrupt("return");case 4:return r=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?g(Object(r),!0).forEach(function(t){(0,n.Z)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({storeId:F.storeId,employeeId:parseInt(C,10),visit_date:j?(0,b.WU)(j,"yyyy-MM-dd"):"",purpose:"Others"===N?k:N,isSelfGenerated:"MANAGER"!==X},"MANAGER"===X&&{assignedById:q}),e.prev=5,e.next=8,fetch("https://api.gajkesaristeels.in/visit/create",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(L)},body:JSON.stringify(r)});case 8:if(!(a=e.sent).ok){e.next=17;break}return e.next=12,a.json();case 12:console.log("Visit created successfully:",e.sent),s(),e.next=18;break;case 17:console.error("Failed to create visit");case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(5),console.error("Error creating visit:",e.t0);case 23:case"end":return e.stop()}},e,null,[[5,20]])})),function(e){return r.apply(this,arguments)});return(0,v.jsxs)("form",{className:"space-y-6",onSubmit:ee,children:[(0,v.jsxs)("div",{children:[(0,v.jsx)(u._,{htmlFor:"visitDate",children:"Visit Date"}),(0,v.jsxs)(p.J2,{children:[(0,v.jsx)(p.xo,{asChild:!0,children:(0,v.jsxs)(d.z,{variant:"outline",className:(0,y.cn)("w-full justify-start text-left font-normal",!j&&"text-muted-foreground"),children:[(0,v.jsx)(h.Que,{className:"mr-2 h-4 w-4"}),j?(0,b.WU)(j,"PPP"):(0,v.jsx)("span",{children:"Pick a date"})]})}),(0,v.jsx)(p.yk,{className:"w-auto p-0",align:"start",children:(0,v.jsx)(f.f,{mode:"single",selected:j,onSelect:O,initialFocus:!0})})]})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)(u._,{htmlFor:"visitPurpose",children:"Visit Purpose"}),(0,v.jsxs)(m.Ph,{value:N,onValueChange:P,children:[(0,v.jsx)(m.i4,{children:(0,v.jsx)(m.ki,{placeholder:"Select visit purpose"})}),(0,v.jsx)(m.Bw,{children:["Follow Up","Order","Birthday","Payment","Others"].map(function(e){return(0,v.jsx)(m.Ql,{value:e,children:e},e)})})]})]}),"Others"===N&&(0,v.jsxs)("div",{children:[(0,v.jsx)(u._,{htmlFor:"otherPurpose",children:"Other Purpose"}),(0,v.jsx)(l.I,{id:"otherPurpose",value:k,onChange:function(e){return S(e.target.value)},placeholder:"Specify other purpose"})]}),(0,v.jsxs)("div",{children:[(0,v.jsx)(u._,{htmlFor:"employee",children:"Employee"}),(0,v.jsxs)(m.Ph,{value:C,onValueChange:function(e){A(e),G(null),Q(""),K(e)},children:[(0,v.jsx)(m.i4,{children:(0,v.jsx)(m.ki,{placeholder:"Select an employee"})}),(0,v.jsx)(m.Bw,{children:D.map(function(e){return(0,v.jsx)(m.Ql,{value:e.id.toString(),children:"".concat(e.firstName," ").concat(e.lastName)},e.id)})})]})]}),(0,v.jsxs)("div",{ref:Y,children:[(0,v.jsx)(u._,{htmlFor:"store",children:"Store"}),(0,v.jsx)(l.I,{type:"text",placeholder:"Search and select store...",value:F?F.storeName:M,onChange:function(e){Q(e.target.value),G(null),W(!0)},onFocus:function(){return W(!0)},disabled:!C}),J&&R.length>0&&(0,v.jsx)("div",{className:"absolute z-10 w-full bg-white border border-gray-300 mt-1 rounded-md shadow-lg",children:R.slice(0,5).map(function(e){return(0,v.jsx)("div",{className:"p-2 hover:bg-gray-100 cursor-pointer",onClick:function(){G(e),Q(""),W(!1)},children:e.storeName},e.storeId)})})]}),(0,v.jsx)("div",{className:"flex justify-end",children:(0,v.jsx)(d.z,{type:"submit",children:"Submit Visit"})})]})}},54205:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/AddVisits",function(){return r(29410)}])}},function(e){e.O(0,[9545,6066,3800,5059,3192,2888,9774,179],function(){return e(e.s=54205)}),_N_E=e.O()}]);